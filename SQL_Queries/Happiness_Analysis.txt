--This project aims to briefly analyze data on global happiness rankings
--The source of the data is data on the global happiness rating from available on Kaggle (2019)
The name of the table is 'happy'



This query allows viewing the top 10 happiest countries:

	SELECT `Country or region`, `Overall rank`, `GDP per capita`, Score
	FROM happy
	ORDER BY 'Overall rank'
	LIMIT
	10;

Next, we can do the opposite and review the 10 most miserable countries

	SELECT `Country or region`, `Overall rank`, `GDP per capita`, Score
	FROM happy
	ORDER BY 2 DESC
	LIMIT 10

Next, I assume that if the country will have a level of happiness below the average, then it is unhappy, and if it is higher, then it is happy, the result is quite obvious, the data is almost simply divided in half

	SELECT a.Happiness, COUNT(*) 
	FROM 
	(SELECT `Country or region`, `Overall rank`, Score, CASE WHEN Score > 
	(SELECT AVG(Score)
	FROM happy) 
	THEN 'Happy' ELSE 'Not Happy' END AS Happiness
	FROM happy) a
	GROUP BY 1

Next, we can see what percentage of the happiness level of a certain country falls from the total, as well as in which quartile the values are

	SELECT `Overall rank`, 
	`Country or region`, 
	Score, 
	ROUND(Score/(SELECT SUM(Score) FROM happy), 5) * 100 AS percentage,
	NTILE(4) OVER (ORDER BY Score) AS Happiness_Rank_Quartile
	FROM happy

The following query shows the country, its overall ranking and its ranking in each category (Finland is first, but it does not rank 1 in any category, this may be due to the fact that certain countries can be ranked first in a certain category at the same time , but at the same time have a bad position in others)

	SELECT a.ranking, a.country, a.soc_support, b.life_expect, c.freed_choices, 	d.generosity
	FROM
  	(SELECT `Overall rank` as ranking, `Country or region` as country, 
  	        rank() OVER (order by `Social support` DESC) as soc_support
 	  FROM happy) a
	JOIN
	(SELECT `Country or region`, 
	          rank() OVER (order by `Healthy life expectancy` DESC) as life_expect
	   FROM happy) b
	ON a.country = b.`Country or region`
	JOIN
 	 (SELECT `Country or region`,
 	         rank() OVER (order by `Freedom to make life choices` DESC) as 	freed_choices
	   FROM happy) c
	ON a.country = c.`Country or region`
	JOIN
 	 (SELECT `Country or region`,
   	       rank() OVER (order by `Generosity` DESC) as generosity
  	 FROM happy) d
	ON a.country = d.`Country or region`
	ORDER BY 1



There is also a shorter way to get the same result, here GDP per capita has already been added

	SELECT `Overall rank`,
	`Country or region`,
	RANK() OVER (order by `GDP per capita` DESC) AS GDP,
	RANK() OVER (order by `Social support` DESC) AS soc_support,
	RANK() OVER (order by `Healthy life expectancy` DESC) AS healthy_life,
	RANK() OVER (order by `Freedom to make life choices` DESC) AS freedom_choices,
	RANK() OVER (order by `Generosity` DESC) AS generosity,
	RANK() OVER (order by `Perceptions of corruption` DESC) AS corruption
	FROM happy
	ORDER BY 1

The next query uses the previous query, but defines a certain indicator that sums up all positions in all rankings for a certain country, the lower the number, the better, from this point of view the leaders are slightly different. This is just another, crude way to view the leaders and underdogs

	SELECT a.country, (a.soc_support + a.healthy_life + a.freedom_choices
	+ a.generosity + a.corruption) AS sum_rank
	FROM
	(SELECT `Overall rank`,
	`Country or region` as country,
	RANK() OVER (order by `Social support` DESC) AS soc_support,
	RANK() OVER (order by `Healthy life expectancy` DESC) AS healthy_life,
	RANK() OVER (order by `Freedom to make life choices` DESC) AS freedom_choices,
	RANK() OVER (order by `Generosity` DESC) AS generosity,
	RANK() OVER (order by `Perceptions of corruption` DESC) AS corruption
	FROM happy
	ORDER BY 1)  a
	ORDER BY 2

The next query is again identical to the previous one, but here the results of clearly defined countries are chosen as an example

	SELECT a.country, (a.soc_support + a.healthy_life + a.freedom_choices
	+ a.generosity + a.corruption) AS sum_rank
	FROM
	(SELECT `Overall rank`,
	`Country or region` as country,
	RANK() OVER (order by `Social support` DESC) AS soc_support,
	RANK() OVER (order by `Healthy life expectancy` DESC) AS healthy_life,
	RANK() OVER (order by `Freedom to make life choices` DESC) AS freedom_choices,
	RANK() OVER (order by `Generosity` DESC) AS generosity,
	RANK() OVER (order by `Perceptions of corruption` DESC) AS corruption
	FROM happy
	ORDER BY 1)  a
	WHERE a.country IN ('United States', 'China', 'India', 'Russia', 'United Kingdom')
	ORDER BY 2

Further, as an example, filtering by points and GDP per capita was used (the result will be Costa Rica)

	SELECT `Country or region`
	from happy
	WHERE Score >= 7 AND `GDP per capita` < 1.1

The last request forms groups depending on the country's happiness rating and counts the number of countries in each group (You can form more or fewer groups, specifically this result will be similar to a normal distribution). Groups can also be associated with certain names such as: "Very Happy", "Happy", "Unhappy", etc.

	SELECT score_group, COUNT(*) FROM (SELECT `Country or region`,
	CASE WHEN Score BETWEEN 2 AND 3 THEN 'first_group'
	WHEN Score BETWEEN 3 AND 4 THEN 'second_group'
	WHEN Score BETWEEN 4 AND 5 THEN 'third_group'
	WHEN Score BETWEEN 5 AND 6 THEN 'fourth_group'
	WHEN Score BETWEEN 6 AND 7 THEN 'fifth_group'
	WHEN Score BETWEEN 7 AND 8 THEN 'sixth_group'
	END AS score_group
	FROM happy) a
	GROUP BY 1

CONCLUSION:

The provided SQL queries offer valuable insights into the global happiness rankings, allowing for a comprehensive analysis of happiness levels across different countries. The data, sourced from Kaggle, provides a rich dataset that can be used to understand factors influencing happiness and to compare countries based on their overall happiness scores and specific category rankings.

Understanding Happiness Distribution: By examining the top 10 happiest and 10 most miserable countries, we gain a clear understanding of the range of happiness levels worldwide. This information can be used to identify countries that are thriving in terms of happiness and those that might require further attention and support.

Categorizing Countries: The queries that classify countries as 'Happy' or 'Not Happy' based on the average happiness score provide a simple yet effective way to group countries into distinct categories. This categorization can help policymakers and researchers quickly identify countries that might need intervention programs to improve happiness levels.

Identifying Influential Factors: The queries that rank countries in different categories (e.g., social support, life expectancy, freedom, generosity) enable a deeper exploration of the factors that contribute to overall happiness. Understanding the relative strengths and weaknesses of each country in various aspects can guide targeted efforts for improving well-being.

Comparing Country Performance: The queries that rank countries based on the sum of their ranks in different categories offer an alternative perspective on comparing countries' overall performance. This analysis allows for the identification of countries that excel in multiple aspects and those that might lag in certain areas.

Filtering and Targeting: The queries that filter countries based on specific happiness score and GDP per capita criteria help pinpoint countries with a specific level of happiness and economic condition. Such filtering can be useful for targeted interventions and comparisons with countries facing similar challenges.

Grouping and Visualizing Data: The query that groups countries based on happiness ratings and counts the number of countries in each group allows for the creation of visualizations such as histograms or pie charts. These visualizations can provide a clear picture of the distribution of happiness levels and facilitate easy communication of findings to stakeholders.

Overall, the information derived from these SQL queries can be instrumental in shaping public policies, aid programs, and international collaborations aimed at enhancing global happiness and well-being. It provides a data-driven approach to understanding the complex factors influencing happiness and supports evidence-based decision-making to create a happier world. Additionally, the analysis and insights generated from these queries can be used for research purposes, academic studies, and for enriching public discourse on happiness and human development.